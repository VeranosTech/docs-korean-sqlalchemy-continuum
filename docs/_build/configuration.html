

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ko" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ko" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuration &mdash; SQLAlchemy-Continuum 1.3.9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="Continuum Schema" href="schema.html" />
    <link rel="prev" title="Plugins" href="plugins.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SQLAlchemy-Continuum
          

          
          </a>

          
            
            
              <div class="version">
                1.3.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">소개</a></li>
<li class="toctree-l1"><a class="reference internal" href="version_objects.html">버전 객체</a></li>
<li class="toctree-l1"><a class="reference internal" href="revert.html">Reverting changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="queries.html">Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="transactions.html">Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="native_versioning.html">Native versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#global-and-class-level-configuration">Global and class level configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#versioning-strategies">Versioning strategies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#validity">Validity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subquery">Subquery</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#column-exclusion-and-inclusion">Column exclusion and inclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-configuration-options">Basic configuration options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customizing-transaction-user-class">Customizing transaction user class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customizing-versioned-mappers">Customizing versioned mappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customizing-versioned-sessions">Customizing versioned sessions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Continuum Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="alembic.html">Alembic migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SQLAlchemy-Continuum</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="제목 주소">¶</a></h1>
<div class="section" id="global-and-class-level-configuration">
<h2>Global and class level configuration<a class="headerlink" href="#global-and-class-level-configuration" title="제목 주소">¶</a></h2>
<p>All Continuum configuration parameters can be set on global level (manager level) and on class level. Setting an option at manager level affects all classes within the scope of the manager's class instrumentation listener (by default all SQLAlchemy declarative models).</p>
<p>In the following example we set 'transaction_column_name' configuration option to False at the manager level.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make_versioned</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;transaction_column_name&#39;</span><span class="p">:</span> <span class="s1">&#39;my_tx_id&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>As the name suggests class level configuration only applies to given class. Class level configuration can be passed to __versioned__ class attribute.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__versioned__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;transaction_column_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tx_id&#39;</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="versioning-strategies">
<h2>Versioning strategies<a class="headerlink" href="#versioning-strategies" title="제목 주소">¶</a></h2>
<p>Similar to Hibernate Envers SQLAlchemy-Continuum offers two distinct versioning strategies 'validity' and 'subquery'. The default strategy is 'validity'.</p>
<div class="section" id="validity">
<h3>Validity<a class="headerlink" href="#validity" title="제목 주소">¶</a></h3>
<p>The 'validity' strategy saves two columns in each history table, namely 'transaction_id' and 'end_transaction_id'. The names of these columns can be configured with configuration options <cite>transaction_column_name</cite> and <cite>end_transaction_column_name</cite>.</p>
<p>As with 'subquery' strategy for each inserted, updated and deleted entity Continuum creates new version in the history table. However it also updates the end_transaction_id of the previous version to point at the current version. This creates a little bit of overhead during data manipulation.</p>
<p>With 'validity' strategy version traversal is very fast. When accessing previous version Continuum tries to find the version record where the primary keys match and end_transaction_id is the same as the transaction_id of the given version record. When accessing the next version Continuum tries to find the version record where the primary keys match and transaction_id is the same as the end_transaction_id of the given version record.</p>
<dl class="docutils">
<dt>Pros:</dt>
<dd><ul class="first last simple">
<li>Version traversal is much faster since no correlated subqueries are needed</li>
</ul>
</dd>
<dt>Cons:</dt>
<dd><ul class="first last simple">
<li>Updates, inserts and deletes are little bit slower</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="subquery">
<h3>Subquery<a class="headerlink" href="#subquery" title="제목 주소">¶</a></h3>
<p>The 'subquery' strategy uses one column in each history table, namely 'transaction_id'. The name of this column can be configured with configuration option <cite>transaction_column_name</cite>.</p>
<p>After each inserted, updated and deleted entity Continuum creates new version in the history table and sets the 'transaction_id' column to point at the current transaction.</p>
<p>With 'subquery' strategy the version traversal is slow. When accessing previous and next versions of given version object needs correlated subqueries.</p>
<dl class="docutils">
<dt>Pros:</dt>
<dd><ul class="first last simple">
<li>Updates, inserts and deletes little bit faster than in 'validity' strategy</li>
</ul>
</dd>
<dt>Cons:</dt>
<dd><ul class="first last simple">
<li>Version traversel much slower</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="column-exclusion-and-inclusion">
<h2>Column exclusion and inclusion<a class="headerlink" href="#column-exclusion-and-inclusion" title="제목 주소">¶</a></h2>
<p>With <cite>exclude</cite> configuration option you can define which entity attributes you want to get versioned. By default Continuum versions all entity attributes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__versioned__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;exclude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;picture&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">Unicode</span><span class="p">(</span><span class="mi">255</span><span class="p">))</span>
    <span class="n">picture</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">LargeBinary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="basic-configuration-options">
<h2>Basic configuration options<a class="headerlink" href="#basic-configuration-options" title="제목 주소">¶</a></h2>
<p>Here is a full list of configuration options:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>base_classes (default: None)</dt>
<dd>A tuple defining history class base classes.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>table_name (default: '%s_version')</dt>
<dd>The name of the history table.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>transaction_column_name (default: 'transaction_id')</dt>
<dd>The name of the transaction column (used by history tables).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>end_transaction_column_name (default: 'end_transaction_id')</dt>
<dd>The name of the end transaction column in history table when using the validity versioning strategy.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>operation_type_column_name (default: 'operation_type')</dt>
<dd>The name of the operation type column (used by history tables).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>strategy (default: 'validity')</dt>
<dd>The versioning strategy to use. Either 'validity' or 'subquery'</dd>
</dl>
</li>
</ul>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Article</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__versioned__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;transaction_column_name&#39;</span><span class="p">:</span> <span class="s1">&#39;tx_id&#39;</span>
    <span class="p">}</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;user&#39;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">Unicode</span><span class="p">(</span><span class="mi">255</span><span class="p">))</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">UnicodeText</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="customizing-transaction-user-class">
<h2>Customizing transaction user class<a class="headerlink" href="#customizing-transaction-user-class" title="제목 주소">¶</a></h2>
<p>By default Continuum tries to build a relationship between 'User' class and Transaction class. If you have differently named user class you can simply pass its name to make_versioned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make_versioned</span><span class="p">(</span><span class="n">user_cls</span><span class="o">=</span><span class="s1">&#39;MyUserClass&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you don't want transactions to contain any user references you can also disable this feature.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make_versioned</span><span class="p">(</span><span class="n">user_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="customizing-versioned-mappers">
<h2>Customizing versioned mappers<a class="headerlink" href="#customizing-versioned-mappers" title="제목 주소">¶</a></h2>
<p>By default SQLAlchemy-Continuum versions all mappers. You can override this behaviour by passing the desired mapper class/object to make_versioned function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make_versioned</span><span class="p">(</span><span class="n">mapper</span><span class="o">=</span><span class="n">my_mapper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="customizing-versioned-sessions">
<h2>Customizing versioned sessions<a class="headerlink" href="#customizing-versioned-sessions" title="제목 주소">¶</a></h2>
<p>By default SQLAlchemy-Continuum versions all sessions. You can override this behaviour by passing the desired session class/object to make_versioned function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make_versioned</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">my_session</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="schema.html" class="btn btn-neutral float-right" title="Continuum Schema" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plugins.html" class="btn btn-neutral" title="Plugins" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, Konsta Vesterinen.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.3.9',
            LANGUAGE:'ko',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>